<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDBX Profile Comparison</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #000;
            color: #e4e4e7;
            padding: 24px;
            line-height: 1.5;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        h1 { color: #3b82f6; margin-bottom: 8px; }
        .subtitle { color: #71717a; margin-bottom: 24px; }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .profile-card {
            background: #12121a;
            border-radius: 10px;
            border: 1px solid #1e1e2a;
            overflow: hidden;
        }
        .profile-card.baseline { border-top: 3px solid #22c55e; }
        .profile-card.rpc_stress { border-top: 3px solid #a855f7; }
        .profile-card.metrics_stress { border-top: 3px solid #f87171; }

        .card-header {
            padding: 16px;
            background: #0a0a0f;
            border-bottom: 1px solid #1e1e2a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .card-title { font-size: 16px; font-weight: 600; }
        .card-badge {
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        .badge-baseline { background: #22c55e20; color: #22c55e; }
        .badge-rpc { background: #a855f720; color: #a855f7; }
        .badge-metrics { background: #f8717120; color: #f87171; }

        .card-body { padding: 16px; }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        .metric {
            background: #0a0a0f;
            padding: 12px;
            border-radius: 6px;
        }
        .metric-label {
            font-size: 11px;
            color: #71717a;
            text-transform: uppercase;
            margin-bottom: 4px;
        }
        .metric-value {
            font-size: 20px;
            font-weight: 700;
            color: #3b82f6;
        }
        .metric-value.major { color: #f87171; }
        .metric-value.good { color: #22c55e; }

        .delta {
            font-size: 12px;
            margin-left: 8px;
            padding: 2px 6px;
            border-radius: 4px;
        }
        .delta.up { background: #f8717120; color: #f87171; }
        .delta.down { background: #22c55e20; color: #22c55e; }

        .section { margin-bottom: 24px; }
        .section-title {
            font-size: 14px;
            color: #3b82f6;
            text-transform: uppercase;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #1e1e2a;
        }

        .table-comparison {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        .table-comparison th,
        .table-comparison td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid #1e1e2a;
        }
        .table-comparison th {
            background: #0a0a0f;
            color: #71717a;
            font-weight: 500;
            text-transform: uppercase;
            font-size: 11px;
        }
        .table-comparison td {
            font-variant-numeric: tabular-nums;
        }
        .table-comparison tr:hover { background: #1a1a24; }

        .bar-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .bar {
            height: 8px;
            border-radius: 4px;
            transition: width 0.3s;
        }
        .bar.baseline { background: #22c55e; }
        .bar.rpc { background: #a855f7; }
        .bar.metrics { background: #f87171; }
    </style>
</head>
<body>
    <div class="container">
        <h1>MDBX Profile Comparison</h1>
        <p class="subtitle">baseline vs stressed workload analysis</p>

        <div id="comparison-content"></div>
    </div>

    <script>
const DATA = [
{
  "attribution": {
    "directly_attributed": 365187,
    "timestamp_fallback": 0,
    "uncorrelated": 647
  },
  "cursor_ops": {
    "by_table": [
      {
        "avg_latency_us": 84.42948469240567,
        "name": "HashedStorages",
        "ops": 284238,
        "p95_latency_us": 181.459,
        "pct": 34.69854632283646
      },
      {
        "avg_latency_us": 121.42530392772294,
        "name": "HashedAccounts",
        "ops": 207092,
        "p95_latency_us": 315.449,
        "pct": 25.28089613313085
      },
      {
        "avg_latency_us": 158.56357769626322,
        "name": "StoragesTrie",
        "ops": 118043,
        "p95_latency_us": 519.531,
        "pct": 14.41017915826379
      },
      {
        "avg_latency_us": 106.03279272172506,
        "name": "AccountsTrie",
        "ops": 107498,
        "p95_latency_us": 175.097,
        "pct": 13.122891142677167
      },
      {
        "avg_latency_us": 4.916575860930796,
        "name": "AccountsTrieChangeSets",
        "ops": 18178,
        "p95_latency_us": 18.244,
        "pct": 2.219091659301434
      },
      {
        "avg_latency_us": 261.7706042188282,
        "name": "PlainStorageState",
        "ops": 15976,
        "p95_latency_us": 1201.227,
        "pct": 1.950281018208808
      },
      {
        "avg_latency_us": 4.9902243392747385,
        "name": "StoragesTrieChangeSets",
        "ops": 14643,
        "p95_latency_us": 19.898,
        "pct": 1.787554140562818
      },
      {
        "avg_latency_us": 49.39588061336254,
        "name": "StoragesHistory",
        "ops": 11869,
        "p95_latency_us": 179.245,
        "pct": 1.4489162121382289
      },
      {
        "avg_latency_us": 2.307786015248796,
        "name": "StorageChangeSets",
        "ops": 9968,
        "p95_latency_us": 3.076,
        "pct": 1.2168503498688907
      },
      {
        "avg_latency_us": 243.4981484432459,
        "name": "PlainAccountState",
        "ops": 8158,
        "p95_latency_us": 791.18,
        "pct": 0.9958933742205469
      },
      {
        "avg_latency_us": 48.24117106773823,
        "name": "AccountsHistory",
        "ops": 6968,
        "p95_latency_us": 171.982,
        "pct": 0.8506233184075472
      },
      {
        "avg_latency_us": 2.399076417704011,
        "name": "AccountChangeSets",
        "ops": 5784,
        "p95_latency_us": 3.116,
        "pct": 0.7060857166574703
      },
      {
        "avg_latency_us": 3.0206499501826634,
        "name": "StageCheckpoints",
        "ops": 3011,
        "p95_latency_us": 4.028,
        "pct": 0.3675698639100351
      },
      {
        "avg_latency_us": 9.241925677937731,
        "name": "HeaderNumbers",
        "ops": 2987,
        "p95_latency_us": 11.742,
        "pct": 0.36464004765834435
      },
      {
        "avg_latency_us": 330.06803206997085,
        "name": "TransactionHashNumbers",
        "ops": 2058,
        "p95_latency_us": 449.851,
        "pct": 0.2512317435824816
      }
    ],
    "latency_avg_us": 106.61521000312513,
    "latency_p95_us": 248.555,
    "latency_p99_us": 3054.492,
    "rate_per_sec": 12159.625680366886,
    "seek_ratio": 69.68384841130714,
    "total": 819164
  },
  "label": "baseline",
  "page_faults": {
    "major": 135465,
    "major_ratio": 0.37029089696419687,
    "minor": 230369,
    "random_ratio": 0.8818695962365342,
    "rate_per_sec": 5155.620377221389,
    "sequential_ratio": 0.11813040376346584,
    "total": 365834,
    "unique_pages": 193229
  },
  "tables": [
    {
      "fault_pct": 18.622380642586528,
      "faults": 68127,
      "major_faults": 30476,
      "name": "HashedAccounts",
      "slow_ops": 18076,
      "time_lost_ms": 24215.922493,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 19.862287266902477,
      "faults": 72663,
      "major_faults": 30992,
      "name": "HashedStorages",
      "slow_ops": 18386,
      "time_lost_ms": 22575.904658,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 22.36888862161527,
      "faults": 81833,
      "major_faults": 29336,
      "name": "StoragesTrie",
      "slow_ops": 13794,
      "time_lost_ms": 17761.32302,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 11.023579000311617,
      "faults": 40328,
      "major_faults": 12615,
      "name": "AccountsTrie",
      "slow_ops": 7444,
      "time_lost_ms": 10507.556884,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 7.270510668773269,
      "faults": 26598,
      "major_faults": 8706,
      "name": "PlainStorageState",
      "slow_ops": 3488,
      "time_lost_ms": 3955.167723,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 6.215113958790052,
      "faults": 22737,
      "major_faults": 8339,
      "name": "PlainAccountState",
      "slow_ops": 4164,
      "time_lost_ms": 1921.074385,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 5.362541480562222,
      "faults": 19618,
      "major_faults": 5995,
      "name": "TransactionHashNumbers",
      "slow_ops": 2057,
      "time_lost_ms": 679.184862,
      "top_op": "DIRECT_PUT"
    },
    {
      "fault_pct": 4.6674174625649885,
      "faults": 17075,
      "major_faults": 5323,
      "name": "StoragesHistory",
      "slow_ops": 1861,
      "time_lost_ms": 336.924857,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 2.729926688060705,
      "faults": 9987,
      "major_faults": 3100,
      "name": "AccountsHistory",
      "slow_ops": 942,
      "time_lost_ms": 159.492462,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 0.10906586047223606,
      "faults": 399,
      "major_faults": 194,
      "name": "Bytecodes",
      "slow_ops": 65,
      "time_lost_ms": 48.498772,
      "top_op": "DIRECT_GET"
    },
    {
      "fault_pct": 0.011753964913047995,
      "faults": 43,
      "major_faults": 17,
      "name": "BlockWithdrawals",
      "slow_ops": 10,
      "time_lost_ms": 9.41081,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 0.028974890250769478,
      "faults": 106,
      "major_faults": 41,
      "name": "HeaderNumbers",
      "slow_ops": 19,
      "time_lost_ms": 7.994833,
      "top_op": "DIRECT_GET"
    },
    {
      "fault_pct": 0.03362180661174194,
      "faults": 123,
      "major_faults": 8,
      "name": "StorageChangeSets",
      "slow_ops": 2,
      "time_lost_ms": 1.131906,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 0.007107048552075531,
      "faults": 26,
      "major_faults": 9,
      "name": "BlockBodyIndices",
      "slow_ops": 3,
      "time_lost_ms": 0.955217,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 0.6628689514916601,
      "faults": 2425,
      "major_faults": 8,
      "name": "StoragesTrieChangeSets",
      "slow_ops": 3,
      "time_lost_ms": 0.863384,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 0.7938026536625901,
      "faults": 2904,
      "major_faults": 7,
      "name": "AccountsTrieChangeSets",
      "slow_ops": 5,
      "time_lost_ms": 0.836635,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 0.006560352509608182,
      "faults": 24,
      "major_faults": 8,
      "name": "TransactionBlocks",
      "slow_ops": 2,
      "time_lost_ms": 0.82349,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 0.015307489189085761,
      "faults": 56,
      "major_faults": 6,
      "name": "AccountChangeSets",
      "slow_ops": 2,
      "time_lost_ms": 0.650668,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 0.027061454102133755,
      "faults": 99,
      "major_faults": 5,
      "name": "Receipts",
      "slow_ops": 2,
      "time_lost_ms": 0.530603,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 0.003280176254804091,
      "faults": 12,
      "major_faults": 2,
      "name": "PruneCheckpoints",
      "slow_ops": 3,
      "time_lost_ms": 0.336278,
      "top_op": "DIRECT_GET"
    }
  ],
  "threads": [
    {
      "faults": 156259,
      "percentage": 42.713088449952714,
      "tid": 87069
    },
    {
      "faults": 3804,
      "percentage": 1.039815872772897,
      "tid": 87065
    },
    {
      "faults": 3307,
      "percentage": 0.9039619062197609,
      "tid": 150278
    },
    {
      "faults": 3188,
      "percentage": 0.8714334916929536,
      "tid": 150272
    },
    {
      "faults": 2294,
      "percentage": 0.6270603607100489,
      "tid": 87066
    },
    {
      "faults": 1649,
      "percentage": 0.4507508870143289,
      "tid": 150276
    },
    {
      "faults": 1634,
      "percentage": 0.4466506666958238,
      "tid": 150495
    },
    {
      "faults": 1600,
      "percentage": 0.43735683397387887,
      "tid": 150518
    },
    {
      "faults": 1555,
      "percentage": 0.42505617301836346,
      "tid": 150498
    },
    {
      "faults": 1512,
      "percentage": 0.41330220810531554,
      "tid": 150511
    }
  ],
  "trace": {
    "block_range": {
      "block_count": 6,
      "max_block": 24220457,
      "min_block": 24220452
    },
    "duration_secs": 70.958288864,
    "file_size_gb": 658.760929296,
    "total_events": 365834
  },
  "transactions": {
    "aborts": 3409,
    "commit_latency_avg_us": 224158.887,
    "commit_latency_p99_us": 224158.887,
    "commits": 1,
    "max_concurrent_ro": 169,
    "max_concurrent_rw": 1,
    "rate_per_sec": 55.07514008166375,
    "ro_count": 3513,
    "rw_count": 2,
    "total": 3515
  }
}
,
{
  "attribution": {
    "directly_attributed": 295903,
    "timestamp_fallback": 0,
    "uncorrelated": 879
  },
  "cursor_ops": {
    "by_table": [
      {
        "avg_latency_us": 77.47819815653418,
        "name": "HashedStorages",
        "ops": 218176,
        "p95_latency_us": 165.69,
        "pct": 29.888146854344328
      },
      {
        "avg_latency_us": 107.55107114610372,
        "name": "HashedAccounts",
        "ops": 139839,
        "p95_latency_us": 307.104,
        "pct": 19.156683448063287
      },
      {
        "avg_latency_us": 151.23291948007912,
        "name": "StoragesTrie",
        "ops": 88475,
        "p95_latency_us": 522.077,
        "pct": 12.12027809171547
      },
      {
        "avg_latency_us": 124.12246881932796,
        "name": "AccountsTrie",
        "ops": 73924,
        "p95_latency_us": 227.415,
        "pct": 10.126922154868318
      },
      {
        "avg_latency_us": 8.039612534204926,
        "name": "StoragesTrieChangeSets",
        "ops": 52624,
        "p95_latency_us": 30.046,
        "pct": 7.209014007329017
      },
      {
        "avg_latency_us": 7.625179464016862,
        "name": "AccountsTrieChangeSets",
        "ops": 46494,
        "p95_latency_us": 24.997,
        "pct": 6.369259221206206
      },
      {
        "avg_latency_us": 27.516438980014556,
        "name": "StoragesHistory",
        "ops": 35726,
        "p95_latency_us": 165.78,
        "pct": 4.894140210281174
      },
      {
        "avg_latency_us": 2.5627305933778826,
        "name": "StorageChangeSets",
        "ops": 19903,
        "p95_latency_us": 3.086,
        "pct": 2.726531730538717
      },
      {
        "avg_latency_us": 220.32587537156527,
        "name": "PlainStorageState",
        "ops": 13793,
        "p95_latency_us": 985.433,
        "pct": 1.889516764272749
      },
      {
        "avg_latency_us": 35.61098412932753,
        "name": "AccountsHistory",
        "ops": 13547,
        "p95_latency_us": 157.365,
        "pct": 1.8558169800335627
      },
      {
        "avg_latency_us": 2.4103108825121815,
        "name": "AccountChangeSets",
        "ops": 9235,
        "p95_latency_us": 3.085,
        "pct": 1.2651118188979076
      },
      {
        "avg_latency_us": 244.18201651695162,
        "name": "PlainAccountState",
        "ops": 6902,
        "p95_latency_us": 852.123,
        "pct": 0.9455118325970067
      },
      {
        "avg_latency_us": 4.730788658367912,
        "name": "Receipts",
        "ops": 3615,
        "p95_latency_us": 3.927,
        "pct": 0.49522243912462754
      },
      {
        "avg_latency_us": 3.0403361853832442,
        "name": "StageCheckpoints",
        "ops": 2805,
        "p95_latency_us": 4.027,
        "pct": 0.3842597349224289
      },
      {
        "avg_latency_us": 7.410372710951526,
        "name": "HeaderNumbers",
        "ops": 2785,
        "p95_latency_us": 9.958,
        "pct": 0.38151991506558447
      }
    ],
    "latency_avg_us": 85.06194101989794,
    "latency_p95_us": 189.734,
    "latency_p99_us": 2320.83,
    "rate_per_sec": 10788.909136501268,
    "seek_ratio": 57.80650022261037,
    "total": 729975
  },
  "label": "rpc_stress",
  "page_faults": {
    "major": 106563,
    "major_ratio": 0.3590615333814045,
    "minor": 190219,
    "random_ratio": 0.8668513146057194,
    "rate_per_sec": 4161.654594806368,
    "sequential_ratio": 0.13314868539428062,
    "total": 296782,
    "unique_pages": 185303
  },
  "tables": [
    {
      "fault_pct": 17.458269032488495,
      "faults": 51813,
      "major_faults": 21288,
      "name": "HashedStorages",
      "slow_ops": 12998,
      "time_lost_ms": 15841.47634,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 15.52081999582185,
      "faults": 46063,
      "major_faults": 20348,
      "name": "HashedAccounts",
      "slow_ops": 11831,
      "time_lost_ms": 14385.592559,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 19.22825508285543,
      "faults": 57066,
      "major_faults": 18634,
      "name": "StoragesTrie",
      "slow_ops": 9275,
      "time_lost_ms": 12708.934745,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 9.964890053979016,
      "faults": 29574,
      "major_faults": 8958,
      "name": "AccountsTrie",
      "slow_ops": 5515,
      "time_lost_ms": 8606.132341,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 7.5974958050016514,
      "faults": 22548,
      "major_faults": 7253,
      "name": "PlainStorageState",
      "slow_ops": 3201,
      "time_lost_ms": 2844.494525,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 5.733164410240513,
      "faults": 17015,
      "major_faults": 6286,
      "name": "PlainAccountState",
      "slow_ops": 3176,
      "time_lost_ms": 1613.615997,
      "top_op": "DIRECT_GET"
    },
    {
      "fault_pct": 9.35973205922192,
      "faults": 27778,
      "major_faults": 8992,
      "name": "StoragesHistory",
      "slow_ops": 3167,
      "time_lost_ms": 551.737135,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 4.09997910924517,
      "faults": 12168,
      "major_faults": 3644,
      "name": "TransactionHashNumbers",
      "slow_ops": 1272,
      "time_lost_ms": 441.778949,
      "top_op": "DIRECT_PUT"
    },
    {
      "fault_pct": 4.843959539325161,
      "faults": 14376,
      "major_faults": 4275,
      "name": "AccountsHistory",
      "slow_ops": 936,
      "time_lost_ms": 167.327907,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 2.913586403488082,
      "faults": 8647,
      "major_faults": 3333,
      "name": "StoragesTrieChangeSets",
      "slow_ops": 587,
      "time_lost_ms": 124.383659,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 2.5055427889831594,
      "faults": 7436,
      "major_faults": 2601,
      "name": "AccountsTrieChangeSets",
      "slow_ops": 390,
      "time_lost_ms": 91.907214,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 0.1789192066904327,
      "faults": 531,
      "major_faults": 255,
      "name": "Bytecodes",
      "slow_ops": 85,
      "time_lost_ms": 58.620638,
      "top_op": "DIRECT_GET"
    },
    {
      "fault_pct": 0.024597179074202617,
      "faults": 73,
      "major_faults": 23,
      "name": "HeaderNumbers",
      "slow_ops": 12,
      "time_lost_ms": 3.067726,
      "top_op": "DIRECT_GET"
    },
    {
      "fault_pct": 0.11186662263883927,
      "faults": 332,
      "major_faults": 117,
      "name": "StorageChangeSets",
      "slow_ops": 18,
      "time_lost_ms": 2.879057,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 0.039422876050434326,
      "faults": 117,
      "major_faults": 41,
      "name": "AccountChangeSets",
      "slow_ops": 9,
      "time_lost_ms": 1.674291,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 0.09299755375999892,
      "faults": 276,
      "major_faults": 100,
      "name": "Receipts",
      "slow_ops": 8,
      "time_lost_ms": 1.414624,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 0.0074128484881158556,
      "faults": 22,
      "major_faults": 7,
      "name": "BlockBodyIndices",
      "slow_ops": 5,
      "time_lost_ms": 0.707953,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 0.0053911625368115315,
      "faults": 16,
      "major_faults": 4,
      "name": "TransactionBlocks",
      "slow_ops": 2,
      "time_lost_ms": 0.461442,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 0.014488749317680991,
      "faults": 43,
      "major_faults": 17,
      "name": "BlockWithdrawals",
      "slow_ops": 1,
      "time_lost_ms": 0.177412,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 0.0016847382927536038,
      "faults": 5,
      "major_faults": 1,
      "name": "PruneCheckpoints",
      "slow_ops": 0,
      "time_lost_ms": 0.0,
      "top_op": "DIRECT_GET"
    }
  ],
  "threads": [
    {
      "faults": 142385,
      "percentage": 47.976292362744374,
      "tid": 87069
    },
    {
      "faults": 3049,
      "percentage": 1.0273534109211475,
      "tid": 87065
    },
    {
      "faults": 2980,
      "percentage": 1.0041040224811477,
      "tid": 87066
    },
    {
      "faults": 2110,
      "percentage": 0.7109595595420207,
      "tid": 150491
    },
    {
      "faults": 2013,
      "percentage": 0.6782756366626008,
      "tid": 150534
    },
    {
      "faults": 2011,
      "percentage": 0.6776017413454993,
      "tid": 150495
    },
    {
      "faults": 1939,
      "percentage": 0.6533415099298475,
      "tid": 150503
    },
    {
      "faults": 1923,
      "percentage": 0.6479503473930359,
      "tid": 150504
    },
    {
      "faults": 1857,
      "percentage": 0.6257118019286884,
      "tid": 150499
    },
    {
      "faults": 1823,
      "percentage": 0.6142555815379639,
      "tid": 150519
    }
  ],
  "trace": {
    "block_range": {
      "block_count": 6,
      "max_block": 24220463,
      "min_block": 24220458
    },
    "duration_secs": 71.313462768,
    "file_size_gb": 658.760982544,
    "total_events": 296782
  },
  "transactions": {
    "aborts": 3718,
    "commit_latency_avg_us": 124377.06933333333,
    "commit_latency_p99_us": 198614.998,
    "commits": 3,
    "max_concurrent_ro": 66,
    "max_concurrent_rw": 1,
    "rate_per_sec": 62.04350613653795,
    "ro_count": 3719,
    "rw_count": 3,
    "total": 3722
  }
}
,
{
  "attribution": {
    "directly_attributed": 445104,
    "timestamp_fallback": 0,
    "uncorrelated": 1131
  },
  "cursor_ops": {
    "by_table": [
      {
        "avg_latency_us": 79.79763753702227,
        "name": "HashedStorages",
        "ops": 365996,
        "p95_latency_us": 134.541,
        "pct": 32.8029533735876
      },
      {
        "avg_latency_us": 111.56373836569709,
        "name": "HashedAccounts",
        "ops": 237251,
        "p95_latency_us": 256.67,
        "pct": 21.26398510048479
      },
      {
        "avg_latency_us": 156.3140408167658,
        "name": "StoragesTrie",
        "ops": 139379,
        "p95_latency_us": 476.04,
        "pct": 12.49205684831874
      },
      {
        "avg_latency_us": 116.96333863040498,
        "name": "AccountsTrie",
        "ops": 124723,
        "p95_latency_us": 172.853,
        "pct": 11.178490348566559
      },
      {
        "avg_latency_us": 7.5947088502894955,
        "name": "AccountsTrieChangeSets",
        "ops": 56823,
        "p95_latency_us": 31.519,
        "pct": 5.0928486091306135
      },
      {
        "avg_latency_us": 7.777756767817315,
        "name": "StoragesTrieChangeSets",
        "ops": 48871,
        "p95_latency_us": 40.175,
        "pct": 4.380138401295641
      },
      {
        "avg_latency_us": 30.51137848046931,
        "name": "StoragesHistory",
        "ops": 34945,
        "p95_latency_us": 160.631,
        "pct": 3.1319992722325343
      },
      {
        "avg_latency_us": 2.5541263016894957,
        "name": "StorageChangeSets",
        "ops": 23143,
        "p95_latency_us": 3.106,
        "pct": 2.0742269039140804
      },
      {
        "avg_latency_us": 285.08918060818934,
        "name": "PlainStorageState",
        "ops": 21638,
        "p95_latency_us": 1242.003,
        "pct": 1.9393389684523559
      },
      {
        "avg_latency_us": 34.059938726268335,
        "name": "AccountsHistory",
        "ops": 15749,
        "p95_latency_us": 97.012,
        "pct": 1.411528302715415
      },
      {
        "avg_latency_us": 2.8114367088607595,
        "name": "FREE_DBI (internal)",
        "ops": 12798,
        "p95_latency_us": 2.705,
        "pct": 1.1470403973682064
      },
      {
        "avg_latency_us": 2.4433835604842127,
        "name": "AccountChangeSets",
        "ops": 11813,
        "p95_latency_us": 3.126,
        "pct": 1.0587582602055496
      },
      {
        "avg_latency_us": 338.4216828282828,
        "name": "PlainAccountState",
        "ops": 8415,
        "p95_latency_us": 1482.913,
        "pct": 0.7542072936281807
      },
      {
        "avg_latency_us": 3.453218060903045,
        "name": "Receipts",
        "ops": 5714,
        "p95_latency_us": 2.896,
        "pct": 0.5121260220786007
      },
      {
        "avg_latency_us": 3.149560966402416,
        "name": "StageCheckpoints",
        "ops": 2649,
        "p95_latency_us": 4.338,
        "pct": 0.23742069171967328
      }
    ],
    "latency_avg_us": 93.77432771046327,
    "latency_p95_us": 189.905,
    "latency_p99_us": 2684.851,
    "rate_per_sec": 15752.376463759536,
    "seek_ratio": 61.8101333553217,
    "total": 1115741
  },
  "label": "metrics_stress",
  "page_faults": {
    "major": 160960,
    "major_ratio": 0.3607068024695508,
    "minor": 285275,
    "random_ratio": 0.8753591165173429,
    "rate_per_sec": 6160.987643361507,
    "sequential_ratio": 0.12464088348265707,
    "total": 446235,
    "unique_pages": 226988
  },
  "tables": [
    {
      "fault_pct": 19.266978161730925,
      "faults": 85976,
      "major_faults": 36003,
      "name": "HashedStorages",
      "slow_ops": 21006,
      "time_lost_ms": 27428.598317,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 16.441561060875994,
      "faults": 73368,
      "major_faults": 32417,
      "name": "HashedAccounts",
      "slow_ops": 18983,
      "time_lost_ms": 25383.937383,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 20.8901139534102,
      "faults": 93219,
      "major_faults": 32309,
      "name": "StoragesTrie",
      "slow_ops": 15077,
      "time_lost_ms": 20660.224796,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 10.51755241072529,
      "faults": 46933,
      "major_faults": 14181,
      "name": "AccountsTrie",
      "slow_ops": 8196,
      "time_lost_ms": 13498.033209,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 7.728214954004057,
      "faults": 34486,
      "major_faults": 11169,
      "name": "PlainStorageState",
      "slow_ops": 4855,
      "time_lost_ms": 5873.201629,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 5.575313455914484,
      "faults": 24879,
      "major_faults": 8799,
      "name": "PlainAccountState",
      "slow_ops": 4453,
      "time_lost_ms": 2759.222506,
      "top_op": "CURSOR_PUT"
    },
    {
      "fault_pct": 4.816744540432731,
      "faults": 21494,
      "major_faults": 6490,
      "name": "TransactionHashNumbers",
      "slow_ops": 2264,
      "time_lost_ms": 791.528993,
      "top_op": "DIRECT_PUT"
    },
    {
      "fault_pct": 6.761907963292884,
      "faults": 30174,
      "major_faults": 8837,
      "name": "StoragesHistory",
      "slow_ops": 2804,
      "time_lost_ms": 486.976207,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 0.19630911963427344,
      "faults": 876,
      "major_faults": 428,
      "name": "Bytecodes",
      "slow_ops": 148,
      "time_lost_ms": 138.861962,
      "top_op": "DIRECT_GET"
    },
    {
      "fault_pct": 3.4813495131489014,
      "faults": 15535,
      "major_faults": 4189,
      "name": "AccountsHistory",
      "slow_ops": 686,
      "time_lost_ms": 118.407467,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 2.0242697233520452,
      "faults": 9033,
      "major_faults": 2760,
      "name": "AccountsTrieChangeSets",
      "slow_ops": 410,
      "time_lost_ms": 90.464905,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 1.8111533160778515,
      "faults": 8082,
      "major_faults": 2551,
      "name": "StoragesTrieChangeSets",
      "slow_ops": 459,
      "time_lost_ms": 87.624049,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 0.019272356493775702,
      "faults": 86,
      "major_faults": 38,
      "name": "BlockWithdrawals",
      "slow_ops": 19,
      "time_lost_ms": 33.98534,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 0.0013445830111936535,
      "faults": 6,
      "major_faults": 3,
      "name": "FREE_DBI (internal)",
      "slow_ops": 8,
      "time_lost_ms": 5.502351,
      "top_op": "CURSOR_GET"
    },
    {
      "fault_pct": 0.02039284233643708,
      "faults": 91,
      "major_faults": 31,
      "name": "HeaderNumbers",
      "slow_ops": 14,
      "time_lost_ms": 3.76423,
      "top_op": "DIRECT_GET"
    },
    {
      "fault_pct": 0.0880701872331843,
      "faults": 393,
      "major_faults": 125,
      "name": "StorageChangeSets",
      "slow_ops": 21,
      "time_lost_ms": 3.508791,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 0.0091879839098233,
      "faults": 41,
      "major_faults": 16,
      "name": "BlockBodyIndices",
      "slow_ops": 8,
      "time_lost_ms": 2.682939,
      "top_op": "DIRECT_GET"
    },
    {
      "fault_pct": 0.030925409257454035,
      "faults": 138,
      "major_faults": 43,
      "name": "AccountChangeSets",
      "slow_ops": 11,
      "time_lost_ms": 2.442368,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 0.06028213833518213,
      "faults": 269,
      "major_faults": 76,
      "name": "Receipts",
      "slow_ops": 6,
      "time_lost_ms": 1.152195,
      "top_op": "CURSOR_DEL"
    },
    {
      "fault_pct": 0.0017927773482582048,
      "faults": 8,
      "major_faults": 2,
      "name": "ChainState",
      "slow_ops": 1,
      "time_lost_ms": 0.24076,
      "top_op": "DIRECT_PUT"
    }
  ],
  "threads": [
    {
      "faults": 208076,
      "percentage": 46.629242439521775,
      "tid": 87069
    },
    {
      "faults": 3203,
      "percentage": 0.7177832308088787,
      "tid": 87065
    },
    {
      "faults": 2790,
      "percentage": 0.6252311002050489,
      "tid": 87066
    },
    {
      "faults": 2132,
      "percentage": 0.47777516331081155,
      "tid": 153881
    },
    {
      "faults": 2003,
      "percentage": 0.44886662857014803,
      "tid": 153891
    },
    {
      "faults": 1961,
      "percentage": 0.4394545474917924,
      "tid": 151822
    },
    {
      "faults": 1859,
      "percentage": 0.41659663630150034,
      "tid": 153896
    },
    {
      "faults": 1851,
      "percentage": 0.41480385895324207,
      "tid": 151819
    },
    {
      "faults": 1840,
      "percentage": 0.41233879009938706,
      "tid": 153845
    },
    {
      "faults": 1829,
      "percentage": 0.40987372124553206,
      "tid": 151794
    }
  ],
  "trace": {
    "block_range": {
      "block_count": 6,
      "max_block": 24220469,
      "min_block": 24220464
    },
    "duration_secs": 72.429134066,
    "file_size_gb": 658.76088424,
    "total_events": 446235
  },
  "transactions": {
    "aborts": 3127,
    "commit_latency_avg_us": 103819.3936,
    "commit_latency_p99_us": 274966.327,
    "commits": 5,
    "max_concurrent_ro": 114,
    "max_concurrent_rw": 1,
    "rate_per_sec": 49.73776384911717,
    "ro_count": 3176,
    "rw_count": 5,
    "total": 3181
  }
}
];

        const fmt = n => {
            if (n === null || n === undefined) return '-';
            if (n >= 1e6) return (n/1e6).toFixed(1) + 'M';
            if (n >= 1e3) return (n/1e3).toFixed(1) + 'K';
            return n.toFixed ? n.toFixed(0) : n;
        };

        const fmtPct = n => (n * 100).toFixed(1) + '%';
        const fmtDur = s => s < 60 ? s.toFixed(1) + 's' : (s/60).toFixed(1) + 'm';

        function getDelta(current, baseline) {
            if (!baseline || baseline === 0) return null;
            const pct = ((current - baseline) / baseline * 100);
            return pct;
        }

        function deltaHtml(current, baseline, inverse = false) {
            const delta = getDelta(current, baseline);
            if (delta === null) return '';
            const isUp = delta > 0;
            const cls = inverse ? (isUp ? 'down' : 'up') : (isUp ? 'up' : 'down');
            const sign = isUp ? '+' : '';
            return `<span class="delta ${cls}">${sign}${delta.toFixed(0)}%</span>`;
        }

        function getBadgeClass(label) {
            if (label === 'baseline') return 'badge-baseline';
            if (label === 'rpc_stress') return 'badge-rpc';
            if (label === 'metrics_stress') return 'badge-metrics';
            return '';
        }

        // Check if data loaded
        if (!DATA || !Array.isArray(DATA) || DATA.length === 0) {
            document.getElementById('comparison-content').innerHTML =
                '<p style="color: #f87171; margin-bottom: 16px;">No profile data found. Check that the traces were captured and analyzed correctly.</p>' +
                '<p style="color: #71717a;">Make sure the .json files were generated in the session directory.</p>';
        } else {

        // Find baseline for delta calculations
        const baseline = DATA.find(d => d && d.label === 'baseline');

        // Generate comparison cards
        let html = '<div class="comparison-grid">';

        for (const profile of DATA) {
            const pf = profile.page_faults;
            const base = baseline?.page_faults;
            const isBaseline = profile.label === 'baseline';

            html += `
            <div class="profile-card ${profile.label}">
                <div class="card-header">
                    <span class="card-title">${profile.label.replace('_', ' ')}</span>
                    <span class="card-badge ${getBadgeClass(profile.label)}">${fmtDur(profile.trace.duration_secs)}</span>
                </div>
                <div class="card-body">
                    <div class="metric-grid">
                        <div class="metric">
                            <div class="metric-label">Page Faults</div>
                            <div class="metric-value">${fmt(pf.total)}${isBaseline ? '' : deltaHtml(pf.total, base?.total)}</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Major (Disk)</div>
                            <div class="metric-value major">${fmt(pf.major)}${isBaseline ? '' : deltaHtml(pf.major, base?.major)}</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Fault Rate</div>
                            <div class="metric-value">${fmt(pf.rate_per_sec)}/s${isBaseline ? '' : deltaHtml(pf.rate_per_sec, base?.rate_per_sec)}</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Major Ratio</div>
                            <div class="metric-value ${pf.major_ratio > 0.5 ? 'major' : ''}">${fmtPct(pf.major_ratio)}</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Sequential</div>
                            <div class="metric-value good">${fmtPct(pf.sequential_ratio)}</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Unique Pages</div>
                            <div class="metric-value">${fmt(pf.unique_pages)}</div>
                        </div>
                    </div>
                </div>
            </div>`;
        }
        html += '</div>';

        // Table comparison
        if (DATA.length > 0 && DATA[0].tables) {
            html += `
            <div class="section">
                <div class="section-title">Top Tables by Faults</div>
                <table class="table-comparison">
                    <thead>
                        <tr>
                            <th>Table</th>`;

            for (const profile of DATA) {
                html += `<th>${profile.label.replace('_', ' ')}</th>`;
            }
            html += '</tr></thead><tbody>';

            // Collect all table names
            const allTables = new Set();
            for (const profile of DATA) {
                for (const t of profile.tables || []) {
                    allTables.add(t.name);
                }
            }

            // Find max for bar scaling
            let maxFaults = 0;
            for (const profile of DATA) {
                for (const t of profile.tables || []) {
                    if (t.faults > maxFaults) maxFaults = t.faults;
                }
            }

            // Sort tables by total faults across all profiles
            const tableOrder = [...allTables].map(name => {
                let total = 0;
                for (const profile of DATA) {
                    const t = (profile.tables || []).find(x => x.name === name);
                    if (t) total += t.faults;
                }
                return { name, total };
            }).sort((a, b) => b.total - a.total).slice(0, 15);

            for (const { name } of tableOrder) {
                html += `<tr><td>${name}</td>`;
                for (const profile of DATA) {
                    const t = (profile.tables || []).find(x => x.name === name);
                    const faults = t ? t.faults : 0;
                    const major = t ? t.major_faults : 0;
                    const barWidth = maxFaults > 0 ? (faults / maxFaults * 100) : 0;
                    const barClass = profile.label === 'baseline' ? 'baseline' :
                                    profile.label === 'rpc_stress' ? 'rpc' : 'metrics';
                    html += `<td>
                        <div class="bar-container">
                            <div class="bar ${barClass}" style="width: ${barWidth}%; min-width: ${faults > 0 ? 4 : 0}px;"></div>
                            <span>${fmt(faults)} (${fmt(major)} major)</span>
                        </div>
                    </td>`;
                }
                html += '</tr>';
            }

            html += '</tbody></table></div>';
        }

        document.getElementById('comparison-content').innerHTML = html;
        } // end else (data exists)
    </script>
</body>
</html>
